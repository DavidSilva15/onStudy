let wordAula = document.querySelectorAll('.word-aula');
let wordAtv = document.querySelectorAll('.word-atv');
let wordAvaliacao = document.querySelectorAll('.word-avaliacao');

export const wordDetails = {
    videoLink: [
        '../videos/word/aula6/aula6.mp4',
        '../videos/word/aula7/aula7.mp4',
        '../videos/word/aula8/aula8.mp4',
        '../videos/word/aula9/aula9.mp4',
        '../videos/word/aula10/aula10.mp4',
        '../videos/word/aula11/aula11.mp4',
        '../videos/word/aula12/aula12.mp4',
        '../videos/word/aula13/aula13.mp4',
        //'../videos/word/aula14/aula14.mp4',
        //'../videos/word/aula15/aula15.mp4',
        //'../videos/word/aula16/aula16.mp4'
    ],
    pratica: [
        [
            '../videos/word/aula6/aula6/1.png',
            '../videos/word/aula6/aula6/2.png',
            '../videos/word/aula6/aula6/3.png',
            '../videos/word/aula6/aula6/4.png',
            '../videos/word/aula6/aula6/5.png',
            '../videos/word/aula6/aula6/6.png',
            '../videos/word/aula6/aula6/7.png',
            '../videos/word/aula6/aula6/8.png',
            '../videos/word/aula6/aula6/9.png',
            '../videos/word/aula6/aula6/10.png',
            '../videos/word/aula6/aula6/11.png',
            '../videos/word/aula6/aula6/12.png',
            '../videos/word/aula6/aula6/13.png',
            '../videos/word/aula6/aula6/14.png',
            '../videos/word/aula6/aula6/15.png',
            '../videos/word/aula6/aula6/16.png',
            '../videos/word/aula6/aula6/17.png',
            '../videos/word/aula6/aula6/18.png',
            '../videos/word/aula6/aula6/19.png',
            '../videos/word/aula6/aula6/20.png',
            '../videos/word/aula6/aula6/21.png',
            '../videos/word/aula6/aula6/22.png',
            '../videos/word/aula6/aula6/23.png',
            '../videos/word/aula6/aula6/24.png',
            '../videos/word/aula6/aula6/25.png',
            '../videos/word/aula6/aula6/26.png',
            '../videos/word/aula6/aula6/27.png'
        ],
        [
            '../videos/word/aula7/aula7/1.png',
            '../videos/word/aula7/aula7/2.png',
            '../videos/word/aula7/aula7/3.png',
            '../videos/word/aula7/aula7/4.png',
            '../videos/word/aula7/aula7/5.png',
            '../videos/word/aula7/aula7/6.png',
            '../videos/word/aula7/aula7/7.png',
            '../videos/word/aula7/aula7/8.png',
            '../videos/word/aula7/aula7/9.png',
            '../videos/word/aula7/aula7/10.png',
            '../videos/word/aula7/aula7/11.png',
            '../videos/word/aula7/aula7/12.png',
            '../videos/word/aula7/aula7/13.png',
            '../videos/word/aula7/aula7/14.png',
            '../videos/word/aula7/aula7/15.png',
            '../videos/word/aula7/aula7/16.png',
            '../videos/word/aula7/aula7/17.png',
            '../videos/word/aula7/aula7/18.png',
            '../videos/word/aula7/aula7/19.png',
            '../videos/word/aula7/aula7/20.png',
            '../videos/word/aula7/aula7/21.png',
            '../videos/word/aula7/aula7/22.png'
        ],
        [
            '../videos/word/aula8/aula8/1.png',
            '../videos/word/aula8/aula8/2.png',
            '../videos/word/aula8/aula8/3.png',
            '../videos/word/aula8/aula8/4.png',
            '../videos/word/aula8/aula8/5.png',
            '../videos/word/aula8/aula8/6.png',
            '../videos/word/aula8/aula8/7.png',
            '../videos/word/aula8/aula8/8.png',
            '../videos/word/aula8/aula8/9.png',
            '../videos/word/aula8/aula8/10.png',
            '../videos/word/aula8/aula8/11.png',
            '../videos/word/aula8/aula8/12.png',
            '../videos/word/aula8/aula8/13.png',
            '../videos/word/aula8/aula8/14.png',
            '../videos/word/aula8/aula8/15.png',
            '../videos/word/aula8/aula8/16.png',
            '../videos/word/aula8/aula8/17.png',
            '../videos/word/aula8/aula8/18.png'
        ],
        [
            '../videos/word/aula9/aula9/1.png',
            '../videos/word/aula9/aula9/2.png',
            '../videos/word/aula9/aula9/3.png',
            '../videos/word/aula9/aula9/4.png',
            '../videos/word/aula9/aula9/5.png',
            '../videos/word/aula9/aula9/6.png',
            '../videos/word/aula9/aula9/7.png',
            '../videos/word/aula9/aula9/8.png',
            '../videos/word/aula9/aula9/9.png',
            '../videos/word/aula9/aula9/10.png',
            '../videos/word/aula9/aula9/11.png',
            '../videos/word/aula9/aula9/12.png',
            '../videos/word/aula9/aula9/13.png',
            '../videos/word/aula9/aula9/14.png',
            '../videos/word/aula9/aula9/15.png',
            '../videos/word/aula9/aula9/16.png',
            '../videos/word/aula9/aula9/17.png'
        ],
        [
            '../videos/word/aula10/aula10/1.png',
            '../videos/word/aula10/aula10/2.png',
            '../videos/word/aula10/aula10/3.png',
            '../videos/word/aula10/aula10/4.png',
            '../videos/word/aula10/aula10/5.png',
            '../videos/word/aula10/aula10/6.png',
            '../videos/word/aula10/aula10/7.png',
            '../videos/word/aula10/aula10/8.png',
            '../videos/word/aula10/aula10/9.png',
            '../videos/word/aula10/aula10/10.png',
            '../videos/word/aula10/aula10/11.png',
            '../videos/word/aula10/aula10/12.png'
        ],
        [
            '../videos/word/aula11/aula11/1.png',
            '../videos/word/aula11/aula11/2.png',
            '../videos/word/aula11/aula11/3.png',
            '../videos/word/aula11/aula11/4.png',
            '../videos/word/aula11/aula11/5.png',
            '../videos/word/aula11/aula11/6.png',
            '../videos/word/aula11/aula11/7.png',
            '../videos/word/aula11/aula11/8.png',
            '../videos/word/aula11/aula11/9.png',
            '../videos/word/aula11/aula11/10.png',
            '../videos/word/aula11/aula11/11.png',
            '../videos/word/aula11/aula11/12.png',
            '../videos/word/aula11/aula11/13.png',
            '../videos/word/aula11/aula11/14.png',
            '../videos/word/aula11/aula11/15.png',
            '../videos/word/aula11/aula11/16.png'
        ],
        [
            '../videos/word/aula12/aula12/1.png',
            '../videos/word/aula12/aula12/2.png',
            '../videos/word/aula12/aula12/3.png',
            '../videos/word/aula12/aula12/4.png',
            '../videos/word/aula12/aula12/5.png',
            '../videos/word/aula12/aula12/6.png',
            '../videos/word/aula12/aula12/7.png',
            '../videos/word/aula12/aula12/8.png',
            '../videos/word/aula12/aula12/9.png',
            '../videos/word/aula12/aula12/10.png',
            '../videos/word/aula12/aula12/11.png',
            '../videos/word/aula12/aula12/12.png',
            '../videos/word/aula12/aula12/13.png',
            '../videos/word/aula12/aula12/14.png',
            '../videos/word/aula12/aula12/15.png',
            '../videos/word/aula12/aula12/16.png',
            '../videos/word/aula12/aula12/17.png',
            '../videos/word/aula12/aula12/18.png',
            '../videos/word/aula12/aula12/19.png',
            '../videos/word/aula12/aula12/20.png',
            '../videos/word/aula12/aula12/21.png',
            '../videos/word/aula12/aula12/22.png',
            '../videos/word/aula12/aula12/23.png',
            '../videos/word/aula12/aula12/24.png',
            '../videos/word/aula12/aula12/25.png'
        ],
        [ // Prints ainda não disponiveis
            '../videos/word/aula13/aula13/1.png',
            '../videos/word/aula13/aula13/2.png',
            '../videos/word/aula13/aula13/3.png',
            '../videos/word/aula13/aula13/4.png',
            '../videos/word/aula13/aula13/5.png',
            '../videos/word/aula13/aula13/6.png',
            '../videos/word/aula13/aula13/7.png',
            '../videos/word/aula13/aula13/8.png',
            '../videos/word/aula13/aula13/9.png',
            '../videos/word/aula13/aula13/10.png',
            '../videos/word/aula13/aula13/11.png',
            '../videos/word/aula13/aula13/12.png',
            '../videos/word/aula13/aula13/13.png',
            '../videos/word/aula13/aula13/14.png',
            '../videos/word/aula13/aula13/15.png',
            '../videos/word/aula13/aula13/16.png',
            '../videos/word/aula13/aula13/17.png',
            '../videos/word/aula13/aula13/18.png',
            '../videos/word/aula13/aula13/19.png',
            '../videos/word/aula13/aula13/20.png',
            '../videos/word/aula13/aula13/21.png',
            '../videos/word/aula13/aula13/22.png',
            '../videos/word/aula13/aula13/23.png',
            '../videos/word/aula13/aula13/24.png',
            '../videos/word/aula13/aula13/25.png'
        ],
        [ // Prints ainda não disponiveis
            '../videos/word/aula14/aula14/1.png',
            '../videos/word/aula14/aula14/2.png',
            '../videos/word/aula14/aula14/3.png',
            '../videos/word/aula14/aula14/4.png',
            '../videos/word/aula14/aula14/5.png',
            '../videos/word/aula14/aula14/6.png',
            '../videos/word/aula14/aula14/7.png',
            '../videos/word/aula14/aula14/8.png',
            '../videos/word/aula14/aula14/9.png',
            '../videos/word/aula14/aula14/10.png',
            '../videos/word/aula14/aula14/11.png',
            '../videos/word/aula14/aula14/12.png',
            '../videos/word/aula14/aula14/13.png',
            '../videos/word/aula14/aula14/14.png',
            '../videos/word/aula14/aula14/15.png',
            '../videos/word/aula14/aula14/16.png',
            '../videos/word/aula14/aula14/17.png',
            '../videos/word/aula14/aula14/18.png',
            '../videos/word/aula14/aula14/19.png',
            '../videos/word/aula14/aula14/20.png',
            '../videos/word/aula14/aula14/21.png',
            '../videos/word/aula14/aula14/22.png',
            '../videos/word/aula14/aula14/23.png',
            '../videos/word/aula14/aula14/24.png',
            '../videos/word/aula14/aula14/25.png'
        ],
        [
            '../videos/word/aula15/aula15/1.png',
            '../videos/word/aula15/aula15/2.png',
            '../videos/word/aula15/aula15/3.png',
            '../videos/word/aula15/aula15/4.png',
            '../videos/word/aula15/aula15/5.png',
            '../videos/word/aula15/aula15/6.png',
            '../videos/word/aula15/aula15/7.png',
            '../videos/word/aula15/aula15/8.png',
            '../videos/word/aula15/aula15/9.png',
            '../videos/word/aula15/aula15/10.png',
            '../videos/word/aula15/aula15/11.png',
            '../videos/word/aula15/aula15/12.png',
            '../videos/word/aula15/aula15/13.png',
            '../videos/word/aula15/aula15/14.png',
            '../videos/word/aula15/aula15/15.png',
            '../videos/word/aula15/aula15/16.png',
            '../videos/word/aula15/aula15/17.png',
            '../videos/word/aula15/aula15/18.png',
            '../videos/word/aula15/aula15/19.png',
            '../videos/word/aula15/aula15/20.png',
            '../videos/word/aula15/aula15/21.png',
            '../videos/word/aula15/aula15/22.png',
            '../videos/word/aula15/aula15/23.png',
            '../videos/word/aula15/aula15/24.png',
            '../videos/word/aula15/aula15/25.png'
        ],
        [
            '../videos/word/aula16/aula16/1.png',
            '../videos/word/aula16/aula16/2.png',
            '../videos/word/aula16/aula16/3.png',
            '../videos/word/aula16/aula16/4.png',
            '../videos/word/aula16/aula16/5.png',
            '../videos/word/aula16/aula16/6.png',
            '../videos/word/aula16/aula16/7.png',
            '../videos/word/aula16/aula16/8.png',
            '../videos/word/aula16/aula16/9.png',
            '../videos/word/aula16/aula16/10.png',
            '../videos/word/aula16/aula16/11.png',
            '../videos/word/aula16/aula16/12.png',
            '../videos/word/aula16/aula16/13.png',
            '../videos/word/aula16/aula16/14.png',
            '../videos/word/aula16/aula16/15.png',
            '../videos/word/aula16/aula16/16.png',
            '../videos/word/aula16/aula16/17.png',
            '../videos/word/aula16/aula16/18.png',
            '../videos/word/aula16/aula16/19.png',
            '../videos/word/aula16/aula16/20.png',
            '../videos/word/aula16/aula16/21.png',
            '../videos/word/aula16/aula16/22.png',
            '../videos/word/aula16/aula16/23.png',
            '../videos/word/aula16/aula16/24.png',
            '../videos/word/aula16/aula16/25.png'
        ],
    ],
};

// Função para abrir o vídeo em uma nova janela
function abrirVideo(index) {
    const videoUrl = wordDetails.videoLink[index];

    // Código HTML para a nova janela com controles personalizados
    const videoHtml = `
        <html>
        <head>
            <title>VideoAula</title>
            <!-- Link para o Font Awesome -->
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
            <style>
                * {
                    transition: all 250ms;
                }

                body {
                    font-family: 'Poppins', sans-serif;
                    margin: 0;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    height: 100vh;
                    background-color: black;
                }

                .btnControl {
                    width: 80px;
                    height: 40px;
                    background-color: #252e3d;
                    opacity: 0.8;
                    border-radius: 5px;
                    border-style: none;
                    color: #fff;
                    cursor: pointer;
                    font-size: 20px; /* Tamanho maior para o ícone */
                }

                .btnControl:hover {
                    background-color: #25344D;
                    opacity: 1;
                }

                /* Barra de progresso e exibição de tempo lado a lado */
                .progressWrapper {
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    width: 600px; /* Largura ajustada */
                }

                .progressContainer {
                    width: 50%; /* Ajustando o tamanho da barra */
                    height: 5px;
                    background-color: rgba(255, 255, 255, 0.3); /* Leve opacidade */
                    cursor: none; /* Inicialmente não manipulável */
                }

                .progressBar {
                    height: 100%;
                    width: 0;
                    background-color: #4CAF50; /* Cor da barra */
                    opacity: 0.7; /* Opacidade da barra */
                }

                /* Exibição de tempo */
                .timeDisplay {
                    color: white;
                    font-size: 16px;
                    margin-left: 10px; /* Espaço entre a barra e o tempo */
                }

                .controlWrapper {
                    display: flex;
                    justify-content: center;
                    flex-direction: column;
                    align-items: center;
                    gap: 10px;
                    margin-bottom: 10px;
                }

                .aulaControls {
                    display: flex;
                    align-items: center;
                    position: relative; /* Necessário para posicionar a notificação em relação a este contêiner */
                }

                .toast {
                    background-color: rgba(0, 0, 0, 0.7);
                    color: white;
                    padding: 10px;
                    border-radius: 5px;
                    font-size: 16px;
                    opacity: 1;
                    transition: opacity 0.5s ease-in-out;
                    z-index: 10;
                    display: inline-block;
                    position: absolute;
                    bottom: 70px;
                    width: 250px;
                }

                .toast::after {
                    content: "";
                    position: absolute;
                    top: 100%;
                    left: 50%;
                    transform: translateX(-50%);
                    border-width: 10px;
                    border-style: solid;
                    border-color: rgba(0, 0, 0, 0.7) transparent transparent transparent;
                }
                    
            </style>
        </head>
        <body>
            <video id="videoPlayer" width="100%" height="auto">
                <source src="${videoUrl}" type="video/mp4">
                Seu navegador não suporta vídeos.
            </video>
            <div class="aulaControls" style="position: absolute; bottom: 10px; text-align: center;">
                <!-- Contêiner para o botão de controle -->
                <div class="controlWrapper">
                    
                    <!-- Toast Notification -->
                    <div id="toast" class="toast">Clique aqui para iniciar a aula</div>
                    
                    <button class="btnControl" id="controlBtn" onclick="togglePlayPause()">
                        <i class="fas fa-play"></i> <!-- Ícone de play -->
                    </button>
                </div>
                
                <!-- Barra de progresso e tempo -->
                <div class="progressWrapper">
                    <!-- Barra de progresso -->
                    <div class="progressContainer" id="progressContainer">
                        <div class="progressBar" id="progressBar"></div>
                    </div>
                    <!-- Exibição de tempo -->
                    <div class="timeDisplay" id="timeDisplay">00:00 / 00:00</div>
                </div>
            </div>

            <script>
                // Função para alternar entre play e pause
                function togglePlayPause() {
                    const videoPlayer = document.getElementById('videoPlayer');
                    const controlBtn = document.getElementById('controlBtn');
                    const icon = controlBtn.querySelector('i');

                    if (videoPlayer.paused) {
                        videoPlayer.play();
                        icon.classList.remove('fa-play');
                        icon.classList.add('fa-pause'); // Troca para ícone de pausa
                    } else {
                        videoPlayer.pause();
                        icon.classList.remove('fa-pause');
                        icon.classList.add('fa-play'); // Troca para ícone de play
                    }
                }

                // Função para garantir que o tempo esteja sempre no formato 2 dígitos
                function padTime(time) {
                    return time < 10 ? '0' + time : time;
                }

                // Atualiza a barra de progresso e exibe o tempo
                const videoPlayer = document.getElementById('videoPlayer');
                const progressBar = document.getElementById('progressBar');
                const timeDisplay = document.getElementById('timeDisplay');
                const progressContainer = document.getElementById('progressContainer');

                videoPlayer.addEventListener('timeupdate', function() {
                    const currentTime = videoPlayer.currentTime;
                    const duration = videoPlayer.duration;
                    const progress = (currentTime / duration) * 100;

                    progressBar.style.width = progress + '%'; // Atualiza a largura da barra

                    // Exibe o tempo atual e total em minutos:segundos
                    const currentMinutes = Math.floor(currentTime / 60);
                    const currentSeconds = Math.floor(currentTime % 60);
                    const durationMinutes = Math.floor(duration / 60);
                    const durationSeconds = Math.floor(duration % 60);

                    const formattedCurrentTime = padTime(currentMinutes) + ':' + padTime(currentSeconds);
                    const formattedDuration = padTime(durationMinutes) + ':' + padTime(durationSeconds);

                    timeDisplay.textContent = formattedCurrentTime + ' / ' + formattedDuration;
                });

                // Função para permitir que a barra de progresso seja manipulada
                progressContainer.addEventListener('click', function(event) {
                    if (isControlEnabled) {
                        const progressWidth = progressContainer.clientWidth;
                        const clickPosition = event.offsetX;
                        const newTime = (clickPosition / progressWidth) * videoPlayer.duration;
                        videoPlayer.currentTime = newTime;
                    }
                });

                // Variável para habilitar/desabilitar a interação com a barra de progresso
                let isControlEnabled = false;

                // Função para ativar/desativar a manipulação da barra de progresso
                function enableProgressControl() {
                    isControlEnabled = !isControlEnabled;
                    if (isControlEnabled) {
                        progressContainer.style.cursor = 'pointer'; // Torna a barra manipulável
                    } else {
                        progressContainer.style.cursor = 'none'; // Desabilita a manipulação
                    }
                }

                // Detecta a combinação de teclas CTRL + SHIFT + F12
                window.addEventListener('keydown', function(event) {
                    if (event.ctrlKey && event.shiftKey && event.key === 'F12') {
                        enableProgressControl();
                    }
                });

                // Função para ocultar o toast após 5 segundos
                setTimeout(function() {
                    const toast = document.getElementById('toast');
                    toast.style.opacity = '0'; // Torna o toast invisível
                    setTimeout(function() {
                        toast.style.display = 'none'; // Remove o toast da tela
                    }, 500); // Aguarda 0.5s para a animação de opacidade terminar
                }, 5000); // Exibe o toast por 5 segundos
            </script>
        </body>
        </html>
    `;

    // Abrir nova janela e escrever o conteúdo HTML
    const videoWindow = window.open("", "VideoAula", "width=900,height=500");
    videoWindow.document.write(videoHtml);
    videoWindow.document.close(); // Garante que o conteúdo é renderizado corretamente
}

// Função para exibir o slide de imagens em uma janela externa
function exibirSlide(index) {
    const imagens = wordDetails.pratica[index];
    let currentImageIndex = 0;

    // Criando o conteúdo do slide
    const slideContent = `
        <html>
            <head>
            <style>
                *{
                    transition: all 250ms;
                    font-family: 'Poppins', sans-serif;
                }
                
                body{
                    background-color: #ebebeb;
                }

                .toast {
                    background-color: rgba(0, 0, 0, 0.7);
                    color: white;
                    padding: 10px;
                    border-radius: 5px;
                    font-size: 16px;
                    opacity: 1;
                    transition: opacity 0.5s ease-in-out;
                    z-index: 10;
                    display: inline-block;
                    position: absolute;
                    bottom: 400px;
                    left: 0px;
                    width: 100px;
                }

                .toast::after {
                    content: "";
                    position: absolute;
                    top: 100%;
                    left: 50%;
                    transform: translateX(-50%);
                    border-width: 10px;
                    border-style: solid;
                    border-color: rgba(0, 0, 0, 0.7) transparent transparent transparent;
                }
            
                .btnVoltar{
                    position: absolute;
                    bottom: 50%;
                    left: 20px;
                }
                
                .btnAvancar{
                    position: absolute;
                    bottom: 50%;
                    right: 20px;
                }

                .btnAvancar,
                .btnVoltar{
                    background-color: #252e3d;
                    color: #fff;
                    width: 30px;
                    height: 30px;
                    padding: 40px;
                    border-radius: 40px;
                    border-style: none;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    cursor: pointer;
                    box-shadow: 1px 0px 5px #000;
                    font-weight: 700;
                    font-size: 1.5em;
                }
                    
                .btnAvancar:hover,
                .btnVoltar:hover{
                    background-color: #25344D;
                    scale: 0.9;
                }

                .imgSlide{
                    border-radius: 20px;
                    clip-path: polygon(5% 5%, 95% 5%, 95% 95%, 5% 95%);
                }

            </style>
            </head>
            <body>
                <div style="text-align:center; padding:20px;">
                    <img class="imgSlide" src="${imagens[currentImageIndex]}" style="max-width:100%; max-height:600px; border: 1px solid #000;">
                    <div style="margin-top:20px;">
                        
                        <!-- Toast Notification -->
                        <div id="toast" class="toast">Clique aqui para iniciar a aula</div>

                        <button class="btnVoltar" onclick="alterarImagem(-1)" ><</button>
                        <button class="btnAvancar" onclick="alterarImagem(1)" >></button>
                    </div>
                </div>
            </body>
            <script>
                var imagens = ${JSON.stringify(imagens)};
                var currentImageIndex = 0;
                function alterarImagem(direcao) {
                    currentImageIndex += direcao;
                    if (currentImageIndex < 0) currentImageIndex = 0;
                    if (currentImageIndex >= imagens.length) currentImageIndex = imagens.length - 1;
                    document.querySelector('img').src = imagens[currentImageIndex];
                }

                // Função para ocultar o toast após 5 segundos
                setTimeout(function() {
                    const toast = document.getElementById('toast');
                    toast.style.opacity = '0'; // Torna o toast invisível
                    setTimeout(function() {
                        toast.style.display = 'none'; // Remove o toast da tela
                    }, 500); // Aguarda 0.5s para a animação de opacidade terminar
                }, 5000); // Exibe o toast por 5 segundos
            </script>
        </html>
    `;

    // Abrindo o slide em uma nova janela
    const slideWindow = window.open("", "SlidePratica", "width=800,height=600");
    slideWindow.document.write(slideContent);
}

// Adicionando os eventos aos elementos
wordAula.forEach((item, index) => {
    item.addEventListener('click', () => {
        abrirVideo(index);
    });
});

wordAtv.forEach((item, index) => {
    item.addEventListener('click', () => {
        exibirSlide(index);
    });
});

document.querySelectorAll(".btnAcessar").forEach((btn, index) => {
    btn.addEventListener("click", () => {
        const cursoDetails = document.querySelectorAll(".cursoDetails")[index];

        // Adiciona ou remove a classe 'open' para animar
        if (cursoDetails.classList.contains("open")) {
            cursoDetails.classList.remove("open");

            // Para evitar problemas de layout ao usar 'display: none'
            setTimeout(() => {
                cursoDetails.style.display = "none";
            }, 300); // Tempo igual ao do transition no CSS
        } else {
            cursoDetails.style.display = "block";
            setTimeout(() => {
                cursoDetails.classList.add("open");
            }, 10); // Pequeno delay para a transição funcionar corretamente
        }
    });
});

// Array de questões de Word
const avaliacoes = [

    //avaliação aula 6------------------------------------------------------------------------------
    [
        {
            numero: 1,
            enunciado: "Para elaborar uma lista de compras, precisamos utilizar o recurso de tabela do Word. Para colocar a tabela em um documento no Word, vamos à guia:",
            alternativas: ["A) Inserir", "B) Exibir", "C) Layout", "D) Ajuda"],
            correta: "A"
        },
        {
            numero: 2,
            enunciado: "É possível configurar quais recursos quando inserimos uma tabela em um documento no Word?",
            alternativas: [
                "A) Somente inserir linhas.",
                "B) Efetuar ajuste de largura e altura da tabela, inserir linha e coluna, entre outros.",
                "C) Somente inserir coluna.",
                "D) Somente ajustar a altura da tabela."
            ],
            correta: "B"
        },
        {
            numero: 3,
            enunciado: "Você está fazendo um trabalho de curso e precisa inserir tabela com dados para fazer comparação entre eles. É possível desenhar uma tabela no editor Word?",
            alternativas: [
                "A) Lógico que não",
                "B) Somente as linhas",
                "C) Sim, é possível desenhar",
                "D) Somente as colunas"
            ],
            correta: "C"
        },
        {
            numero: 4,
            enunciado: "Qual a função da ferramenta de sombreamento presente na guia Design da Tabela?",
            alternativas: [
                "A) Alterar a cor fonte do texto",
                "B) Alterar a cor de fundo da tabela",
                "C) Alterar a cor da borda da tabela",
                "D) Deixar o texto transparente"
            ],
            correta: "B"
        },
        {
            numero: 5,
            enunciado: "A medida de 5,08 cm que está na imagem a seguir é referente à configuração de qual recurso?",
            alternativas: [
                "A) Largura da página",
                "B) Altura da tabela",
                "C) Altura da célula",
                "D) Largura da célula"
            ],
            correta: "D"
        },
        {
            numero: 6,
            enunciado: "Qual a funcionalidade do recurso Classificar?",
            alternativas: [
                "A) Colocar os dados da tabela em ordem alfabética",
                "B) Inserir o alfabeto na tabela",
                "C) Preencher todas as células da tabela com o alfabeto",
                "D) Marcar as palavras A e Z que aparecem na tabela"
            ],
            correta: "A"
        },
        {
            numero: 7,
            enunciado: "Qual a função do mesclar células?",
            alternativas: [
                "A) Dividir a tabela",
                "B) Dividir células",
                "C) Mesclar células",
                "D) Mesclar tabela"
            ],
            correta: "C"
        },
        {
            numero: 8,
            enunciado: "Temos uma tabela com 3 colunas e queremos inserir uma quarta coluna. Para isto, utilizamos a ferramenta:",
            alternativas: [
                "A) Inserir abaixo",
                "B) Inserir à direita",
                "C) Inserir à esquerda",
                "D) Inserir acima"
            ],
            correta: "B"
        }
    ],

    //avaliação aula 7-----------------------------------------------------------------
    [
        {
            numero: 1,
            enunciado: "Você está fazendo um trabalho de curso e precisa configurar o texto. Para configurar o recurso de margem da Página vamos à guia:",
            alternativas: [
                "A) LAYOUT.",
                "B) INSERIR.",
                "C) EXIBIR.",
                "D) ARQUIVO."
            ],
            correta: "A"
        },
        {
            numero: 2,
            enunciado: "O recurso da imagem a seguir pode ser usado para qual propósito?",
            alternativas: [
                "A) APLICAR LINHAS AZUIS NAS LATERAIS DO DOCUMENTO.",
                "B) APLICAR MARGENS PREDEFINIDAS À PÁGINA DO DOCUMENTO.",
                "C) APLICAR UM EFEITO ESTÉTICO NA MARGEM.",
                "D) APLICAR UMA TABELA AO DOCUMENTO."
            ],
            correta: "B"
        },
        {
            numero: 3,
            enunciado: "Você está fazendo um trabalho de curso e precisa configurar o texto. Nessas configurações, você se depara com a Medianiz. O que ela é?",
            alternativas: [
                "A) É O MEIO DO DOCUMENTO.",
                "B) É O MEIO DA MARGEM SUPERIOR.",
                "C) É UM RECUO PARA A ENCADERAÇÃO.",
                "D) É O MEIO DA MARGEM ESQUERDA."
            ],
            correta: "C"
        },
        {
            numero: 4,
            enunciado: "Você está fazendo um trabalho de curso e precisa identificar a imagem a seguir. Qual é a orientação dela?",
            alternativas: [
                "A) DEITADO.",
                "B) PAISAGEM.",
                "C) EM PÉ.",
                "D) RETRATO."
            ],
            correta: "B"
        },
        {
            numero: 5,
            enunciado: "Você está fazendo um trabalho para empresa e precisa identificar uma imagem na hora da impressão. A orientação da imagem a seguir é referente a qual opção?",
            alternativas: [
                "A) PAISAGEM.",
                "B) DEITADO.",
                "C) EM PÉ.",
                "D) RETRATO."
            ],
            correta: "D"
        },
        {
            numero: 6,
            enunciado: "Para inserir ou configurar o recurso de cabeçalho em um documento, vamos à guia:",
            alternativas: [
                "A) LAYOUT E CLICAMOS NO RECURSO CABEÇALHO, DO GRUPO CABEÇALHO E RODAPÉ.",
                "B) EXIBIR E CLICAMOS NO RECURSO CABEÇALHO, DO GRUPO CABEÇALHO E RODAPÉ.",
                "C) AJUDA E CLICAMOS NO RECURSO CABEÇALHO, DO GRUPO CABEÇALHO E RODAPÉ.",
                "D) INSERIR E CLICAMOS NO RECURSO CABEÇALHO, DO GRUPO CABEÇALHO E RODAPÉ."
            ],
            correta: "D"
        },
        {
            numero: 7,
            enunciado: "Você está fazendo um portfólio e precisa configurar o texto. Sobre a inserção de numeração de página no Word, marque a opção correta:",
            alternativas: [
                "A) SOMENTE PODEMOS INSERIR A NUMERAÇÃO NA PARTE INFERIOR DO DOCUMENTO.",
                "B) PODEMOS INSERIR A NUMERAÇÃO NA PARTE INFERIOR DO DOCUMENTO.",
                "C) SOMENTE PODEMOS INSERIR A NUMERAÇÃO NA PARTE SUPERIOR DO DOCUMENTO.",
                "D) SOMENTE PODEMOS INSERIR A NUMERAÇÃO NA PARTE SUPERIOR DO DOCUMENTO EM PÁGINAS PARES."
            ],
            correta: "B"
        },
        {
            numero: 8,
            enunciado: "O que é uma margem espelho?",
            alternativas: [
                "A) É UMA MARGEM SEM FUNÇÃO.",
                "B) É UMA MARGEM COM A MEDIDA SUPERIOR DIFERENCIADA.",
                "C) É UM TIPO DE MARGEM QUE É UTILIZADA PARA IMPRESSÃO DE APOSTILAS.",
                "D) É UMA MARGEM MUITO PEQUENA."
            ],
            correta: "C"
        }
    ],

    //avaliação aula 8-----------------------------------------------------------------
    [
        // Aula não possui avaliação
    ],

    //avaliação aula 9-----------------------------------------------------------------
    [
        {
            numero: 1,
            enunciado: "Ana pretende utilizar o recurso de gráfico no Word. Deste modo, em qual guia ela encontrará esse recurso?",
            alternativas: [
                "A) INSERIR.",
                "B) DESENHAR.",
                "C) LAYOUT.",
                "D) ARQUIVO."
            ],
            correta: "A"
        },
        {
            numero: 2,
            enunciado: "Para inserir um recurso para ilustrar os cargos de uma empresa, começando pelo diretor até a secretária, além do recurso de hierarquia da ferramenta SMART, podemos escolher qual outro elemento gráfico?",
            alternativas: [
                "A) PROCESSO.",
                "B) PIRÂMIDE.",
                "C) CICLO.",
                "D) LISTA."
            ],
            correta: "A"
        },
        {
            numero: 3,
            enunciado: "Qual elemento gráfico da ferramenta SMART podemos usar para ilustrar etapas de montagem de um móvel?",
            alternativas: [
                "A) LISTAS.",
                "B) CICLO.",
                "C) PROCESSO.",
                "D) MATRIZ."
            ],
            correta: "C"
        },
        {
            numero: 4,
            enunciado: "Com relação ao SMART, marque a opção correta:",
            alternativas: [
                "A) CONSEGUIMOS CONFIGURAR FORMAS, CORES E TEXTOS EM UM ELEMENTO SMART.",
                "B) CONSEGUIMOS CONFIGURAR SOMENTE FORMAS E TEXTOS EM UM ELEMENTO SMART.",
                "C) CONSEGUIMOS CONFIGURAR CORES E TEXTOS EM UM ELEMENTO SMART.",
                "D) CONSEGUIMOS CONFIGURAR SOMENTE FORMAS E CORES EM UM ELEMENTO SMART."
            ],
            correta: "A"
        },
        {
            numero: 5,
            enunciado: "Uma empresa precisa usar o logotipo 'carinha com sorriso' em um documento. Qual ferramenta podemos indicar para conseguir esse recurso, no Word 2021?",
            alternativas: [
                "A) FERRAMENTA FORMAS.",
                "B) FERRAMENTA CAIXA DE TEXTO.",
                "C) FERRAMENTA DE GRÁFICO.",
                "D) FERRAMENTA DE CABEÇALHO E RODAPÉ."
            ],
            correta: "A"
        },
        {
            numero: 6,
            enunciado: "O que são SmartArt no Word?",
            alternativas: [
                "A) UM RECURSO PARA CRIAR GRÁFICOS VISUAIS, COMO ORGANOGRAMAS, FLUXOGRAMAS E DIAGRAMAS, DE FORMA SIMPLIFICADA.",
                "B) UMA FERRAMENTA DE EDIÇÃO DE TEXTO PARA CORRIGIR ERROS ORTOGRÁFICOS AUTOMATICAMENTE.",
                "C) UM CONJUNTO DE TEMAS E ESTILOS PARA ALTERAR A APARÊNCIA DO DOCUMENTO.",
                "D) UM TIPO DE TABELA AVANÇADA QUE PERMITE CÁLCULOS AUTOMÁTICOS NO WORD."
            ],
            correta: "A"
        },
        {
            numero: 7,
            enunciado: "Qual das opções abaixo é um tipo de SmartArt disponível no Word?",
            alternativas: [
                "A) HIERARQUIA.",
                "B) TABELA DINÂMICA.",
                "C) GRÁFICO DE DISPERSÃO.",
                "D) FÓRMULAS CONDICIONAIS."
            ],
            correta: "A"
        },
        {
            numero: 8,
            enunciado: "Para gerar um documento no qual aplicamos um gráfico para demonstrar a evolução das notas de um aluno, a melhor opção é o recurso de _______________ no editor Word. Complete a frase acima:",
            alternativas: [
                "A) EXPLOSÃO SOLAR.",
                "B) FUNIL.",
                "C) LINHA.",
                "D) PIZZA."
            ],
            correta: "C"
        }
    ],

    //avaliação aula 10------------------------------------------------------------------------------
    [
        {
            numero: 1,
            enunciado: "Qual o nome do recurso da imagem a seguir?",
            alternativas: [
                "A) ESTILO.",
                "B) FONTE.",
                "C) COLUNA.",
                "D) PARÁGRAFO."
            ],
            correta: "D"
        },
        {
            numero: 2,
            enunciado: "Qual o nome do recurso responsável pela formação da imagem a seguir?",
            alternativas: [
                "A) FONTE.",
                "B) SUMÁRIO.",
                "C) CABEÇALHO.",
                "D) LAYOUT."
            ],
            correta: "B"
        },
        {
            numero: 3,
            enunciado: "Qual a finalidade do recurso da imagem, a seguir:",
            alternativas: [
                "A) ATUALIZAR SOMENTE AS PÁGINAS DO SUMÁRIO.",
                "B) ATUALIZAR SOMENTE O TEXTO SUMÁRIO.",
                "C) ATUALIZAR PÁGINAS E O SUMÁRIO INTEIRO.",
                "D) ATUALIZAR A FONTE NO SUMÁRIO."
            ],
            correta: "C"
        },
        {
            numero: 4,
            enunciado: "O recurso de estilo no Word permite:",
            alternativas: [
                "A) TROCAR SOMENTE A COR DO TEXTO.",
                "B) APLICAR UM CONJUNTO DE FORMATAÇÕES.",
                "C) FAZER SOMENTE AJUSTE DE FONTE.",
                "D) APLICAR SOMENTE A OPÇÃO DE ESPAÇAMENTO ENTRE LINHAS."
            ],
            correta: "B"
        },
        {
            numero: 5,
            enunciado: "O recurso de Sumário está na guia:",
            alternativas: [
                "A) DESIGN.",
                "B) REVISÃO.",
                "C) PÁGINA INICIAL.",
                "D) REFERÊNCIAS."
            ],
            correta: "D"
        },
        {
            numero: 6,
            enunciado: "Para inserir um item sumário precisamos:",
            alternativas: [
                "A) COLOCAR O TEXTO EM NEGRITO.",
                "B) COLOCAR O TEXTO EM COR VERMELHA.",
                "C) ALTERAR O TAMANHO.",
                "D) APLICAR O ESTILO."
            ],
            correta: "D"
        },
        {
            numero: 7,
            enunciado: "Ao personalizar o sumário podemos:",
            alternativas: [
                "A) INSERIR IMAGENS.",
                "B) CONFIGURAR AS TABULAÇÕES E O ALINHAMENTO DE PÁGINA.",
                "C) INSERIR TABELA.",
                "D) INSERIR RODAPÉ."
            ],
            correta: "B"
        },
        {
            numero: 8,
            enunciado: "O recurso de preenchimento de tabulação no sumário permite:",
            alternativas: [
                "A) COLORIR O SUMÁRIO.",
                "B) COLOCAR LINKS.",
                "C) PREENCHER COM ALGUM CARACTERE ATÉ O NÚMERO DA PÁGINA.",
                "D) COLOCAR IMAGENS DO TIPO JPG."
            ],
            correta: "C"
        }
    ],

    //avaliação aula 11------------------------------------------------------------------------------
    [
        {
            numero: 1,
            enunciado: "O uso de recuos no documento gera:",
            alternativas: [
                "A) ESPAÇAMENTO EM RELAÇÃO À MARGEM.",
                "B) INSERÇÃO DE IMAGENS.",
                "C) INSERÇÃO DE TABELAS.",
                "D) INSERÇÃO DE COLUNAS."
            ],
            correta: "A"
        },
        {
            numero: 2,
            enunciado: "O recurso de recuos permite:",
            alternativas: [
                "A) RECUAR SOMENTE À ESQUERDA.",
                "B) RECUAR À ESQUERDA E À DIREITA.",
                "C) RECUAR SOMENTE À DIREITA.",
                "D) RECUAR DE CIMA PARA BAIXO."
            ],
            correta: "B"
        },
        {
            numero: 3,
            enunciado: "Utilizamos o recurso de colunas para:",
            alternativas: [
                "A) DIVIDIR IMAGENS.",
                "B) DIVIDIR TABELAS.",
                "C) DIVIDIR O TEXTO.",
                "D) DIVIDIR A MARGEM."
            ],
            correta: "C"
        },
        {
            numero: 4,
            enunciado: "Em relação às colunas no Word, podemos dizer que:",
            alternativas: [
                "A) NÃO EXISTE UMA FERRAMENTA ESPECÍFICA PARA CRIAÇÃO DE COLUNAS;",
                "B) PODEMOS INSERIR ATÉ CINCO COLUNAS.",
                "C) PODEMOS INSERIR DUAS OU MAIS COLUNAS NO DOCUMENTO;",
                "D) NÃO É POSSÍVEL DIVIDIR UM TEXTO EM COLUNAS NO DOCUMENTO;"
            ],
            correta: "C"
        },
        {
            numero: 5,
            enunciado: "Seu líder pediu para você colocar marca d'água em um documento. A opção de marca d'água pode ser usada para:",
            alternativas: [
                "A) DEIXAR MARCAS DE GOTAS DE ÁGUA NO DOCUMENTO.",
                "B) DEIXAR O DOCUMENTO COM BORDAS COLORIDAS.",
                "C) DEIXAR O DOCUMENTO COM COLUNAS.",
                "D) EVITAR CÓPIAS SEM AUTORIZAÇÃO."
            ],
            correta: "D"
        },
        {
            numero: 6,
            enunciado: "A marca d'água está junto ao grupo de:",
            alternativas: [
                "A) AJUDA.",
                "B) PÁGINA INICIAL.",
                "C) LAYOUT DA PÁGINA.",
                "D) PLANO DE FUNDO DA PÁGINA."
            ],
            correta: "C"
        },
        {
            numero: 7,
            enunciado: "O recurso cor da página pode ser usado com a finalidade de:",
            alternativas: [
                "A) DEIXAR TODO DOCUMENTO COM O FUNDO AZUL.",
                "B) COLOCAR COR AO FUNDO DO DOCUMENTO PARA AUMENTAR A ATENÇÃO E O APELO VISUAL PARA SEU CONTEÚDO.",
                "C) DEIXAR TODO DOCUMENTO COM A COR VERMELHA.",
                "D) COLOCAR COR NA FONTE DO DOCUMENTO PARA AUMENTAR A ATENÇÃO PARA SEU CONTEÚDO."
            ],
            correta: "B"
        },
        {
            numero: 8,
            enunciado: "A cor da página permite:",
            alternativas: [
                "A) APLICAR SOMENTE UMA COR.",
                "B) APLICAR SOMENTE IMAGEM.",
                "C) APLICAR ESQUEMAS DE CORES OU IMAGENS OU TEXTURAS PADRONIZADAS.",
                "D) APLICAR SOMENTE TEXTURAS."
            ],
            correta: "C"
        }
    ],

    //avaliação aula 12------------------------------------------------------------------------------
    [
        // Aula não possui avaliação
    ],

    //avaliação aula 13------------------------------------------------------------------------------
    [
        {
            numero: 1,
            enunciado: "Você precisa revisar seu relatório de estágio. Para tal, precisa utilizar o recurso de Ortografia e Gramática, que fica na guia:",
            alternativas: [
                "A) REVISÃO.",
                "B) ARQUIVO.",
                "C) DESENHAR.",
                "D) LAYOUT."
            ],
            correta: "A"
        },
        {
            numero: 2,
            enunciado: "Para exibir informações numéricas, como a quantidade de parágrafos em um documento, clicamos em qual opção?",
            alternativas: [
                "A) DICIONÁRIO DE SINÔNIMOS.",
                "B) CONTAGEM DE PALAVRAS.",
                "C) ADICIONAR TEXTO.",
                "D) ATUALIZAR SUMÁRIO."
            ],
            correta: "B"
        },
        {
            numero: 3,
            enunciado: "Acima da guia Ajuda, temos o ícone de _________. Ao clicar nele, adotamos a pesquisa automática no próprio editor.",
            alternativas: [
                "A) LIVRO.",
                "B) LUPA.",
                "C) LÁPIS.",
                "D) BORRACHA."
            ],
            correta: "B"
        },
        {
            numero: 4,
            enunciado: "O recurso traz um resumo estatístico de quantas páginas tem o documento, quantas palavras, quantos caracteres sem espaço, caracteres com espaço, parágrafos e linhas. Estamos falando de qual recurso?",
            alternativas: [
                "A) SALVAR.",
                "B) IMPRIMIR.",
                "C) DICIONÁRIO DE SINÔNIMOS.",
                "D) CONTAGEM DE PALAVRAS."
            ],
            correta: "D"
        },
        {
            numero: 5,
            enunciado: "A janela de __________ contém a opção mais detalhada, onde a localização pode adotar critérios mais rigorosos de busca, como por exemplo diferenciar maiúscula de minúscula.",
            alternativas: [
                "A) ARQUIVAR.",
                "B) LOCALIZAR.",
                "C) IMPRIMIR.",
                "D) CORRIGIR."
            ],
            correta: "B"
        },
        {
            numero: 6,
            enunciado: "É só posicionar o cursor antes do texto que o editor lê todo texto ou sentença. Estamos falando de qual recurso?",
            alternativas: [
                "A) LER EM VOZ BAIXA.",
                "B) LER EM OUTRO IDIOMA.",
                "C) LER EM VOZ ALTA.",
                "D) LER EM FONEMAS."
            ],
            correta: "C"
        },
        {
            numero: 7,
            enunciado: "Quando uma palavra está certa, porém o corretor aponta como errada, qual procedimento deve ser tomado em relação a palavra?",
            alternativas: [
                "A) ADICIONAR AO DICIONÁRIO.",
                "B) EXCLUIR E NÃO USAR A PALAVRA NUNCA MAIS NO TEXTO.",
                "C) EXCLUIR A PALAVRA.",
                "D) NÃO USAR A PALAVRA NO TEXTO."
            ],
            correta: "A"
        },
        {
            numero: 8,
            enunciado: "Em qual opção podemos acessar a janela de navegação no Word?",
            alternativas: [
                "A) INSERIR.",
                "B) LAYOUT DA PÁGINA.",
                "C) EXIBIR.",
                "D) REFERÊNCIAS."
            ],
            correta: "C"
        }
    ],

    //avaliação aula 14------------------------------------------------------------------------------
    [
        // Avaliação não disponível para essa aula
    ],

    //avaliação aula 15------------------------------------------------------------------------------
    [
        // Avaliação não disponível para essa aula
    ],

    //avaliação aula 16------------------------------------------------------------------------------
    [
        // Avaliação não disponível para essa aula
    ]
];

// Modal das avaliações
wordAvaliacao.forEach((element, index) => {
    element.addEventListener('click', () => {
        abrirPopup(index); // Abre o modal com as questões correspondentes
    });
});

// Função para abrir o pop-up
function abrirPopup(index) {
    const questoes = JSON.stringify(avaliacoes[index]); // Passa as questões da avaliação selecionada
    const popup = window.open('', 'Popup', 'width=960,height=500');
    popup.document.write(`
        <html>
        <head>
            <title>Avaliação</title>
            <style>
                body {
                    margin: 0 50px;    
                    font-family: 'Poppins', sans-serif;
                    margin: 20px;
                    background-color: #252e3d;
                    color: #fff;
                    transition: all 250ms;
                }
                
                h2 {
                    text-align: center;
                }
                
                .questao {
                    margin-bottom: 20px;
                }

                button {
                    margin-top: 10px;
                    display: block;
                }

                #finalizar {
                    background-color: #29af55;
                    color: white;
                    border: none;
                    padding: 10px;
                    cursor: pointer;
                }

                #finalizar:hover {
                    background-color:rgb(24, 129, 59);
                }

                #progresso {
                    margin-top: 20px;
                    text-align: center;
                    font-size: 1.2em;
                }

                form > label{
                    cursor: pointer;
                }

                form > label:hover{
                    color: #fec600;
                }

                .questao-title{
                    margin: 10px 0;
                    border-radius: 5px;
                }

            </style>
        </head>
        <body>
            <h2 class="avaliacao-title">Word - Avaliação: Aula ${index + 6}</h2>
            <div id="avaliacao-container"></div>
            <button id="finalizar">FINALIZAR AVALIAÇÃO</button>
            <div id="progresso"></div>
            <script>
                const questoes = ${questoes};
                const container = document.getElementById('avaliacao-container');
                const finalizarBtn = document.getElementById('finalizar');
                let acertos = 0;

                // Exibe as questões
                questoes.forEach((q, i) => {
                    let questaoHTML = \`
                        <div class="questao">
                            <div class="questao-title">
                                <h3>Questão \${q.numero}</h3>
                                <p>\${q.enunciado}</p>
                            </div>
                            <form id="form-\${i}">
                                <label><input type="radio" name="q\${i}" value="A"> \${q.alternativas[0]}</label><br>
                                <label><input type="radio" name="q\${i}" value="B"> \${q.alternativas[1]}</label><br>
                                <label><input type="radio" name="q\${i}" value="C"> \${q.alternativas[2]}</label><br>
                                <label><input type="radio" name="q\${i}" value="D"> \${q.alternativas[3]}</label><br>
                            </form>
                        </div>
                    \`;
                    container.insertAdjacentHTML('beforeend', questaoHTML);
                });

                // Finaliza e calcula o progresso
                finalizarBtn.addEventListener('click', () => {
                    acertos = 0; // Zera contagem
                    let todasRespondidas = true; // Variável para verificar se todas as questões foram respondidas

                    questoes.forEach((q, i) => {
                        const form = document.getElementById('form-' + i);
                        const resposta = form.querySelector('input[name="q' + i + '"]:checked');
                        const labels = form.querySelectorAll('label');

                        // Reseta cores antes de aplicar as novas
                        labels.forEach(label => {
                            label.style.color = ''; // Remove estilos antigos
                        });

                        if (resposta) {
                            labels.forEach(label => {
                                const input = label.querySelector('input');
                                if (input.value === q.correta) {
                                    // Alternativa correta em verde
                                    label.style.color = 'green';
                                } else if (input.checked) {
                                    // Alternativa incorreta selecionada em vermelho
                                    label.style.color = 'red';
                                }
                            });

                            if (resposta.value === q.correta) {
                                acertos++;
                            }
                        } else {
                            // Caso nenhuma alternativa seja selecionada
                            todasRespondidas = false; // Marca que nem todas as questões foram respondidas
                            labels.forEach(label => {
                                label.style.color = 'red';
                            });
                        }
                    });

                    if (!todasRespondidas) {
                        // Exibe o modal com uma mensagem de erro se nem todas as questões forem respondidas
                        if (!document.getElementById('feedback-modal')) {
                            document.body.insertAdjacentHTML('beforeend', \`
                                <div id="feedback-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 9999; justify-content: center; align-items: center; color: white; font-family: Arial, sans-serif;">
                                    <div style="background: #333; padding: 20px; border-radius: 8px; text-align: center; max-width: 400px; width: 90%;">
                                        <h2 id="modal-title" style="margin-bottom: 10px;"></h2>
                                        <p id="modal-message" style="margin-bottom: 20px;"></p>
                                        <button id="modal-close" style="background: #29af55; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">Fechar</button>
                                    </div>
                                </div>
                            \`);
                        }

                        const feedbackModal = document.getElementById('feedback-modal');
                        const modalTitle = document.getElementById('modal-title');
                        const modalMessage = document.getElementById('modal-message');
                        const modalClose = document.getElementById('modal-close');

                        modalTitle.innerText = 'Atenção!';
                        modalMessage.innerText = 'Você deve responder todas as questões antes de finalizar o questionário.';

                        modalClose.addEventListener('click', () => {
                            feedbackModal.style.display = 'none';
                        });

                        feedbackModal.style.display = 'flex';
                        return; // Interrompe a execução para impedir a exibição do resultado
                    }

                    const percentual = ((acertos / questoes.length) * 100).toFixed(0);
                    document.getElementById('progresso').innerHTML = \`Você acertou \${acertos} de \${questoes.length} questões (\${percentual}%)\`;

                    // Adiciona o modal ao corpo do documento, se ainda não estiver lá
                    if (!document.getElementById('feedback-modal')) {
                        document.body.insertAdjacentHTML('beforeend', \`
                            <div id="feedback-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 9999; justify-content: center; align-items: center; color: white; font-family: Arial, sans-serif;">
                                <div style="background: #333; padding: 20px; border-radius: 8px; text-align: center; max-width: 400px; width: 90%;">
                                    <h2 id="modal-title" style="margin-bottom: 10px;"></h2>
                                    <p id="modal-message" style="margin-bottom: 20px;"></p>
                                    <div style="display: flex; justify-content: center; gap: 10px;">
                                        <button id="modal-close" style="background: #29af55; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">Verificar alternativas</button>
                                        <button id="modal-retry" style="background: #ff9800; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">Tentar Novamente</button>
                                    </div>
                                </div>
                            </div>
                        \`);
                    }

                    // Configura o modal
                    const feedbackModal = document.getElementById('feedback-modal');
                    const modalTitle = document.getElementById('modal-title');
                    const modalMessage = document.getElementById('modal-message');
                    const modalClose = document.getElementById('modal-close');
                    const modalRetry = document.getElementById('modal-retry');

                    modalClose.addEventListener('click', () => {
                        feedbackModal.style.display = 'none';
                    });

                    modalRetry.addEventListener('click', () => {
                        // Reseta as questões
                        questoes.forEach((q, i) => {
                            const form = document.getElementById('form-' + i);
                            const labels = form.querySelectorAll('label');
                            const inputs = form.querySelectorAll('input');

                            // Limpa seleção e cores
                            inputs.forEach(input => input.checked = false);
                            labels.forEach(label => label.style.color = '');
                        });

                        // Oculta o modal
                        feedbackModal.style.display = 'none';

                        // Reseta o progresso
                        document.getElementById('progresso').innerHTML = 'Responda todas as questões para ver o resultado.';
                    });

                    // Exibe o modal com base no desempenho
                    if (percentual >= 70) {
                        modalTitle.innerText = 'Parabéns!';
                        modalMessage.innerText = \`Você acertou \${percentual}% das questões. Excelente trabalho!\`;
                    } else {
                        modalTitle.innerText = 'Tente Novamente';
                        modalMessage.innerText = \`Você acertou apenas \${percentual}% das questões. Continue praticando!\`;
                    }

                    feedbackModal.style.display = 'flex';
                });

            </script>
        </body>
        </html>
    `);
}

let inicioBtn = document.querySelectorAll('.inicio');
inicioBtn.forEach((btn) => {
    btn.addEventListener('click', () => {
        window.location.href = '../index.html'
    });
});

let userName = document.querySelectorAll('.userName');
userName.forEach((userName) => {
    userName.innerHTML = `Aluno: Dev David Silva`;
});
